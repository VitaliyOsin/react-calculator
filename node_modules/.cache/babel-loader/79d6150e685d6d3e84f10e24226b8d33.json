{"ast":null,"code":"import _slicedToArray from\"/home/vitaliyosin/pr/ReactJunior/react-calculator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useCallback}from\"react\";import\"./App.css\";import Calculator from\"./components/calculator\";import{calc}from\"./utils\";import{opers}from\"./utils/lists.js\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){var _useState=useState(\"0\"),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),signFlag=_useState4[0],setSignFlag=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),sign=_useState6[0],setSign=_useState6[1];var _useState7=useState([true,true]),_useState8=_slicedToArray(_useState7,2),commaFlag=_useState8[0],setCommaFlag=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),startAgain=_useState10[0],setStartAgain=_useState10[1];var inputHandler=function inputHandler(m){setInput(m);};var resetHandler=function resetHandler(){setInput(\"0\");setSignFlag(true);setSign(\"\");setCommaFlag([true,true]);setStartAgain(false);};var onBtn=function onBtn(e){var target=e.target;if(target.textContent===\"AC\"){resetHandler();return;}else if(target.textContent===\".\"){if(commaFlag||!startAgain){inputHandler(input+target.textContent);setCommaFlag(false);}}else{if(input===\"0\"||startAgain){inputHandler(target.textContent);setStartAgain(false);}else{inputHandler(input+target.textContent);}}};var onOpBtn=function onOpBtn(e){var target=e.target;setSignFlag(false);setCommaFlag(false);setStartAgain(false);if(signFlag){inputHandler(input+target.dataset.sign);setSign(target.dataset.sign);}};var equalHandler=useCallback(function(){try{var arr;if(sign){arr=input.split(sign);if(arr[1]===\"\")arr[1]=arr[0];else if(arr[0]===\"\")arr[0]=\"0\";}else{return;}var res=calc(arr[0],arr[1],sign);res?setInput(res.toString()):setInput(isNaN(res)?\"Ой!\":res.toString());setCommaFlag(false);setSignFlag(true);setStartAgain(true);setSign(\"\");}catch(err){console.log(\"Ошибка ввода...\");resetHandler();return;}},[input,sign]);var handleKeys=useCallback(function(e){console.log(e.key);var key=e.key;if(Number(key)>=0&&Number(key)<=9){if(input===\"0\"||startAgain){inputHandler(key);setStartAgain(false);}else{inputHandler(input+key);}}else if(opers.find(function(v){return v.value===key;})){setSignFlag(false);//setCommaFlag(true);\nsetStartAgain(false);if(signFlag){inputHandler(input+key);setSign(key);}}else if(key===\"Enter\"||key===\"=\"){equalHandler();}else if(key===\"Delete\"){resetHandler();}else if(key===\"Backspace\"){//console.log(\"SPLIT: \", input.split(\"\"));\nconsole.log(\"SPLIT1: \",input);setInput(function(prev){console.log(\"PREV: \",prev);prev=prev.split(\"\");prev.pop();return prev.join(\"\");});}else if(key===\".\"){if(commaFlag||!startAgain){inputHandler(input+key);}}},[input,commaFlag,equalHandler,signFlag,startAgain]);useEffect(function(){window.addEventListener(\"keydown\",handleKeys);return function(){window.removeEventListener(\"keydown\",handleKeys);};},[input,handleKeys]);return/*#__PURE__*/_jsx(Calculator,{input:input,equalHandler:equalHandler,onBtn:onBtn,onOpBtn:onOpBtn});}export default App;","map":{"version":3,"sources":["/home/vitaliyosin/pr/ReactJunior/react-calculator/src/App.js"],"names":["useState","useEffect","useCallback","Calculator","calc","opers","App","input","setInput","signFlag","setSignFlag","sign","setSign","commaFlag","setCommaFlag","startAgain","setStartAgain","inputHandler","m","resetHandler","onBtn","e","target","textContent","onOpBtn","dataset","equalHandler","arr","split","res","toString","isNaN","err","console","log","handleKeys","key","Number","find","v","value","prev","pop","join","window","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import { useState, useEffect, useCallback } from \"react\";\nimport \"./App.css\";\nimport Calculator from \"./components/calculator\";\nimport { calc } from \"./utils\";\nimport { opers } from \"./utils/lists.js\";\n\nfunction App() {\n  const [input, setInput] = useState(\"0\");\n  const [signFlag, setSignFlag] = useState(true);\n  const [sign, setSign] = useState(\"\");\n  const [commaFlag, setCommaFlag] = useState([true, true]);\n  const [startAgain, setStartAgain] = useState(false);\n\n  const inputHandler = (m) => {\n    setInput(m);\n  };\n\n  const resetHandler = () => {\n    setInput(\"0\");\n    setSignFlag(true);\n    setSign(\"\");\n    setCommaFlag([true, true]);\n    setStartAgain(false);\n  };\n\n  const onBtn = (e) => {\n    const { target } = e;\n\n    if (target.textContent === \"AC\") {\n      resetHandler();\n      return;\n    } else if (target.textContent === \".\") {\n      if (commaFlag || !startAgain) {\n        inputHandler(input + target.textContent);\n        setCommaFlag(false);\n      }\n    } else {\n      if (input === \"0\" || startAgain) {\n        inputHandler(target.textContent);\n        setStartAgain(false);\n      } else {\n        inputHandler(input + target.textContent);\n      }\n    }\n  };\n\n  const onOpBtn = (e) => {\n    const { target } = e;\n    setSignFlag(false);\n    setCommaFlag(false);\n    setStartAgain(false);\n    if (signFlag) {\n      inputHandler(input + target.dataset.sign);\n      setSign(target.dataset.sign);\n    }\n  };\n\n  const equalHandler = useCallback(() => {\n    try {\n      let arr;\n      if (sign) {\n        arr = input.split(sign);\n        if (arr[1] === \"\") arr[1] = arr[0];\n        else if (arr[0] === \"\") arr[0] = \"0\";\n      } else {\n        return;\n      }\n      const res = calc(arr[0], arr[1], sign);\n\n      res\n        ? setInput(res.toString())\n        : setInput(isNaN(res) ? \"Ой!\" : res.toString());\n      setCommaFlag(false);\n      setSignFlag(true);\n      setStartAgain(true);\n      setSign(\"\");\n    } catch (err) {\n      console.log(\"Ошибка ввода...\");\n      resetHandler();\n      return;\n    }\n  }, [input, sign]);\n\n  const handleKeys = useCallback(\n    (e) => {\n      console.log(e.key);\n      const { key } = e;\n      if (Number(key) >= 0 && Number(key) <= 9) {\n        if (input === \"0\" || startAgain) {\n          inputHandler(key);\n          setStartAgain(false);\n        } else {\n          inputHandler(input + key);\n        }\n      } else if (opers.find((v) => v.value === key)) {\n        setSignFlag(false);\n        //setCommaFlag(true);\n        setStartAgain(false);\n        if (signFlag) {\n          inputHandler(input + key);\n          setSign(key);\n        }\n      } else if (key === \"Enter\" || key === \"=\") {\n        equalHandler();\n      } else if (key === \"Delete\") {\n        resetHandler();\n      } else if (key === \"Backspace\") {\n        //console.log(\"SPLIT: \", input.split(\"\"));\n        console.log(\"SPLIT1: \", input);\n        setInput((prev) => {\n          console.log(\"PREV: \", prev);\n          prev = prev.split(\"\");\n          prev.pop();\n          return prev.join(\"\");\n        });\n      } else if (key === \".\") {\n        if (commaFlag || !startAgain) {\n          inputHandler(input + key);\n        }\n      }\n    },\n    [input, commaFlag, equalHandler, signFlag, startAgain]\n  );\n\n  useEffect(() => {\n    window.addEventListener(\"keydown\", handleKeys);\n    return () => {\n      window.removeEventListener(\"keydown\", handleKeys);\n    };\n  }, [input, handleKeys]);\n\n  return (\n    <Calculator\n      input={input}\n      equalHandler={equalHandler}\n      onBtn={onBtn}\n      onOpBtn={onOpBtn}\n    />\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}